<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Apr 8, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20120408" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                javautil-core
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                  <div class="xright">        
                
                 <span id="publishDate">Last Published: 2012-04-08</span>
              &nbsp;| <span id="projectVersion">Version: 0.11.0</span>
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Projects</h5>
                  <ul>
                  <li class="none">
                          <a href="Introduction.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="Usage.html" title="Usage">Usage</a>
            </li>
                  <li class="none">
                          <a href="FAQ.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="Structure.html" title="Structure">Structure</a>
            </li>
                  <li class="none">
                          <a href="Apt_Examples.html" title="Apt Examples">Apt Examples</a>
            </li>
          </ul>
                       <h5>Reports</h5>
                  <ul>
                  <li class="none">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
            </li>
          </ul>
                       <h5>External</h5>
                  <ul>
                  <li class="none">
                          <a href="References.html" title="References">References</a>
            </li>
          </ul>
                                                                                                                   <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                       
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CPD Results<a name="CPD_Results"></a></h2><p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 4.3.</p></div><div class="section"><h2>Duplications<a name="Duplications"></a></h2><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/text/CommaFormatter.java</td><td><a href="./xref/org/javautil/text/CommaFormatter.html#20">20</a></td></tr><tr class="a"><td>org/javautil/text/StringHelper.java</td><td><a href="./xref/org/javautil/text/StringHelper.html#312">312</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public static String formatWithCommas(final Collection&lt;String&gt; words,
			final int leadInLength, final int maxLineLength) {
		int maxLength = 0;
		for (final String word : words) {
			if (word.length() &gt; maxLength) {
				maxLength = word.length();
			}
		}
		final StringBuilder mb = new StringBuilder();
		for (int i = 0; i &lt; leadInLength; i++) {
			mb.append(&quot; &quot;);
		}
		final String margin = mb.toString();
		final int workLength = maxLineLength - maxLength;
		final int wordsPerLine = workLength / (maxLength + 2);

		final StringBuilder b = new StringBuilder();
		int wordsThisLine = 0;

		b.append(margin);

		System.out.println(b.toString());
		int wordNbr = 0;
		for (final String word : words) {
			wordNbr++;

			b.append(word);
			if (wordNbr &lt; words.size()) {
				b.append(&quot;,&quot;);
			}
			for (int i = word.length(); i &lt;= maxLength; i++) {
				b.append(&quot; &quot;);
			}

			wordsThisLine++;

			if (wordsThisLine &gt;= wordsPerLine) {
				b.append(&quot;\n&quot;);
				b.append(margin);
				wordsThisLine = 0;
			}

		}
		final String retval = b.toString();
		System.out.println(b);
		return retval;
	}</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/dataset/DatasetCompoundCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCompoundCrosstabber.html#192">192</a></td></tr><tr class="a"><td>org/javautil/dataset/DatasetCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCrosstabber.html#176">176</a></td></tr><tr class="b"><td colspan='2'><div><pre>			}
			matrix[rowIndex] = row;
			// System.out.println(&quot;row &quot; + ArrayHelper.asString(row));
			// System.out.println(&quot;srcRow &quot; + srcRow);
			rowIndex++;
		}
		return matrix;

	}

	private CrosstabRow getCrosstabRow(final DatasetIterator dsi) {
		final Object[] rowIdentifier = new Object[crosstabColumns
				.getRowIdentifiers().size()];
		int i = 0;
		for (final String colName : crosstabColumns.getRowIdentifiers()) {
			final Object colVal = dsi.getObject(colName);
			rowIdentifier[i++] = colVal;
		}
		CrosstabRow row = rows.get(rowIdentifier);
		if (row == null) {
			row = new CrosstabRow(rowIdentifier);
			rows.put(rowIdentifier, row);
		}
		return row;
	}

	// todo merge this with DatasetCrosstab
	public AbstractDataset getDataSet() {
		crosstab();
		final DatasetIterator dsi = dataSet.getDatasetIterator();
		dsi.getDatasetMetadata();
		final MutableDatasetMetadata meta = dsi.getDatasetMetadata()
				.getMutable();

		final DatasetMetadataImpl newMeta = new DatasetMetadataImpl();
		int index = 0;
		for (final String colName : crosstabColumns.getRowIdentifiers()) {
			final Integer sourceIndex = meta.getColumnIndex(colName);
			final ColumnMetadata src = meta.getColumnMetaData(sourceIndex);
			final ColumnMetadata cmd = src.getCopy();
			cmd.setColumnIndex(index);
			newMeta.addColumn(cmd);
			index++;
		}
		if (logger.isDebugEnabled()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/util/Day.java</td><td><a href="./xref/org/javautil/util/Day.html#129">129</a></td></tr><tr class="a"><td>org/javautil/util/ImmutableDate.java</td><td><a href="./xref/org/javautil/util/ImmutableDate.html#142">142</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public Day(final String date, final String format) throws ParseException {
		super((new java.util.Date()).getTime());
		final SimpleDateFormat formatter = new SimpleDateFormat(format);
		final java.util.Date d = formatter.parse(date);
		super.setTime(d.getTime());
	}

	public final void setDate(
			@SuppressWarnings(&quot;unused&quot;) final java.util.Date date) {
		throw new UnsupportedOperationException(&quot;immutable&quot;);
	}

	public void setDay(@SuppressWarnings(&quot;unused&quot;) final int day) {
		throw new UnsupportedOperationException(&quot;immutable&quot;);
	}

	@Override
	public void setMonth(final int month) {
		throw new UnsupportedOperationException(&quot;immutable&quot;);
	}

	@Override
	public void setTime(final long time) {
		throw new UnsupportedOperationException(&quot;immutable&quot;);
	}

	@Override
	public void setYear(final int year) {
		throw new UnsupportedOperationException(&quot;immutable&quot;);
	}

	@Override
	public String toString() {
		synchronized (formatter) {
			return formatter.format(this);
		}
	}

	public java.sql.Timestamp toTimestamp() {
		return new java.sql.Timestamp(this.getTime());
	}

	@Override
	public void setHours(final int i) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/dataset/AbstractDatasetIterator.java</td><td><a href="./xref/org/javautil/dataset/AbstractDatasetIterator.html#159">159</a></td></tr><tr class="a"><td>org/javautil/dataset/ResultSetIterator.java</td><td><a href="./xref/org/javautil/dataset/ResultSetIterator.html#196">196</a></td></tr><tr class="b"><td colspan='2'><div><pre>	}

	@Override
	public Map&lt;String, Object&gt; getRowAsMap() throws DatasetException {
		final DatasetMetadata metaData = getDatasetMetadata();
		final Map&lt;String, Object&gt; row = new LinkedHashMap&lt;String, Object&gt;();
		for (int i = 0; i &lt; metaData.getColumnCount(); i++) {
			final String columnName = metaData.getColumnName(i);
			final Object columnValue = getObject(i);
			row.put(columnName, columnValue);
		}
		return row;
	}

	@Override
	public List&lt;Object&gt; getRowAsList() {
		final DatasetMetadata meta = getDatasetMetadata();
		final List&lt;Object&gt; row = new ArrayList&lt;Object&gt;(meta.getColumnCount());
		for (int i = 0; i &lt; meta.getColumnCount(); i++) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/dataset/DatasetCompoundCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCompoundCrosstabber.html#45">45</a></td></tr><tr class="a"><td>org/javautil/dataset/DatasetCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCrosstabber.html#43">43</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public void setDataSet(final Dataset ds) {
		dataSet = ds;
	}

	private void crosstab() {
		if (!crosstabComplete) {
			crossTabDataSet();
			crosstabComplete = true;
		}
	}

	@Override
	public String toString() {
		final StringBuilder b = new StringBuilder();
		for (final CrosstabRow row : rows.values()) {
			b.append(row.toString());
		}
		return b.toString();
	}

	/**
	 * Crosstabs the data.
	 * 
	 * Iterates through the source data, Finds the corresponding row identified
	 * by the row id, Extracts the column identifier Adds the data using the
	 * column identifier as the key.
	 * 
	 * When does the densification occur?
	 * 
	 * @throws DatasetException
	 */
	protected final void crossTabDataSet() throws DatasetException {
		logger.debug(&quot;cross tabbing begins&quot;);

		rowCount = 0;

		if (dataSet == null) {
			throw new IllegalStateException(&quot;dataSet is null&quot;);
		}
		final DatasetIterator dsi = dataSet.getDatasetIterator();

		while (dsi.next()) {
			if (logger.isDebugEnabled()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/util/Day.java</td><td><a href="./xref/org/javautil/util/Day.html#72">72</a></td></tr><tr class="a"><td>org/javautil/util/ImmutableDate.java</td><td><a href="./xref/org/javautil/util/ImmutableDate.html#85">85</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public Day(final int year, final int month, final int day,
			final Calendar cal) {
		super(0L); // unfortunate
		// super(date.getTime());
		synchronized (cal) {
			cal.set(Calendar.YEAR, year - 1900);
			cal.set(Calendar.MONTH, month - 1);
			cal.set(Calendar.DATE, day);
			cal.set(Calendar.HOUR_OF_DAY, 0);
			cal.set(Calendar.MINUTE, 0);
			cal.set(Calendar.SECOND, 0);
			cal.set(Calendar.MILLISECOND, 0);

			super.setTime(cal.getTime().getTime());
		}
	}

	public Day(final java.util.Date date) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/collections/ArrayComparator.java</td><td><a href="./xref/org/javautil/collections/ArrayComparator.html#75">75</a></td></tr><tr class="a"><td>org/javautil/collections/StaticArrayComparator.java</td><td><a href="./xref/org/javautil/collections/StaticArrayComparator.html#129">129</a></td></tr><tr class="b"><td colspan='2'><div><pre>		if (!(b instanceof Object[])) {
			throw new IllegalArgumentException(&quot;b &quot; + b.getClass().getName()
					+ &quot; is not an array&quot;);
		}
		final Object[] ac = (Object[]) a;
		final Object[] bc = (Object[]) b;
		int maxIndex;
		if (ac.length &lt; bc.length) {
			maxIndex = ac.length - 1;
		} else {
			maxIndex = bc.length - 1;
		}

		for (int index = 0; index &lt;= maxIndex; index++) {
			if (logger.isDebugEnabled()) {
				logger.debug(&quot;index :&quot; + index);
			}</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/dataset/DatasetCompoundCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCompoundCrosstabber.html#144">144</a></td></tr><tr class="a"><td>org/javautil/dataset/DatasetCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCrosstabber.html#134">134</a></td></tr><tr class="b"><td colspan='2'><div><pre>		}
		return columnId;
	}

	/**
	 * Convert the crosstab to a matrix
	 * 
	 * The width (number of columns) is defined by number of columns in the row
	 * identifier
	 * 
	 * @return
	 */
	public Object[][] getMatrix() {

		crosstab();

		final int columnCount = getColumnCount();
		final Object[][] matrix = new Object[rows.size()][];

		int rowIndex = 0;

		for (final CrosstabRow srcRow : rows.values()) {
			final Object[] row = matrix[rowIndex] = new Object[columnCount];

			int colIndex = 0;
			while (colIndex &lt; srcRow.getRowId().length) {
				row[colIndex] = srcRow.getRowId()[colIndex];
				colIndex++;
			}
			for (final Object[] colId : columnLabels.values()) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/collections/ForestBuilder.java</td><td><a href="./xref/org/javautil/collections/ForestBuilder.html#35">35</a></td></tr><tr class="a"><td>org/javautil/collections/TreeBuilder.java</td><td><a href="./xref/org/javautil/collections/TreeBuilder.html#33">33</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public List&lt;T&gt; buildForest(final List&lt;T&gt; treeNodes) {
		final Map&lt;Integer, List&lt;T&gt;&gt; nodesByParentNodeNbr = new HashMap&lt;Integer, List&lt;T&gt;&gt;();
		for (final T treeNode : treeNodes) {
			List&lt;T&gt; list = nodesByParentNodeNbr
					.get(treeNode.getParentNodeNbr());
			if (list == null) {
				list = new ArrayList&lt;T&gt;();
				nodesByParentNodeNbr.put(treeNode.getParentNodeNbr(), list);
			}
			list.add(treeNode);
		}
		final List&lt;T&gt; roots = nodesByParentNodeNbr.remove(null);
		if (roots == null || roots.size() == 0) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/collections/ArrayComparator.java</td><td><a href="./xref/org/javautil/collections/ArrayComparator.html#159">159</a></td></tr><tr class="a"><td>org/javautil/collections/StaticArrayComparator.java</td><td><a href="./xref/org/javautil/collections/StaticArrayComparator.html#70">70</a></td></tr><tr class="b"><td colspan='2'><div><pre>					throw new ComparisonException(&quot;unable to compare &quot;
							+ a.getClass() + &quot; to &quot; + b.getClass());
				}
			}
		}
		if (retval == Integer.MAX_VALUE) {
			throw new IllegalStateException(&quot;comparison logic failure&quot;);
		}
		return retval;
	}

	private int compareEntryAt(final int index, final int maxIndex,
			final Object[] ac, final Object[] bc) {
		if (index &gt; maxIndex) {
			throw new IllegalStateException(&quot;attempt to compare at index &quot;
					+ index);
		}
		final Object aObj = ac[index];
		final Object bObj = bc[index];
		int objResult;

		objResult = compareObjects(aObj, bObj);

		return objResult;
	}</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/collections/ListComparator.java</td><td><a href="./xref/org/javautil/collections/ListComparator.html#38">38</a></td></tr><tr class="a"><td>org/javautil/collections/StaticArrayComparator.java</td><td><a href="./xref/org/javautil/collections/StaticArrayComparator.html#33">33</a></td></tr><tr class="b"><td colspan='2'><div><pre>	static {
		logger.setLevel(Level.INFO);
	}

	@SuppressWarnings(&quot;unchecked&quot;)
	int compareObjects(final Object a, final Object b)
			throws IllegalArgumentException {
		Comparable ac = null;
		Comparable bc = null;
		try {
			ac = (Comparable) a;

		} catch (final ClassCastException cce) {
			throw new IllegalArgumentException(&quot;class &quot;
					+ a.getClass().getName() + &quot; does not implement comparable&quot;);
		}
		try {
			bc = (Comparable) b;

		} catch (final ClassCastException cce) {
			throw new IllegalArgumentException(&quot;class &quot;
					+ b.getClass().getName() + &quot; does not implement comparable&quot;);
		}</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/util/Day.java</td><td><a href="./xref/org/javautil/util/Day.html#89">89</a></td></tr><tr class="a"><td>org/javautil/util/ImmutableDate.java</td><td><a href="./xref/org/javautil/util/ImmutableDate.html#102">102</a></td></tr><tr class="b"><td colspan='2'><div><pre>	public Day(final java.util.Date date) {
		super(date != null ? date.getTime() : null);
		if (date == null) {
			throw new IllegalArgumentException(&quot;date is null&quot;);
		}
		synchronized (cal) {
			cal.setTime(date);
			cal.set(Calendar.HOUR_OF_DAY, 0);
			cal.set(Calendar.MINUTE, 0);
			cal.set(Calendar.SECOND, 0);
			cal.set(Calendar.MILLISECOND, 0);

			super.setTime(cal.getTime().getTime());
		}
	}

	public Day(final java.util.Date date, final Calendar cal) {</pre></div></td></tr></table><table border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/javautil/dataset/DatasetCompoundCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCompoundCrosstabber.html#287">287</a></td></tr><tr class="a"><td>org/javautil/dataset/DatasetCrosstabber.java</td><td><a href="./xref/org/javautil/dataset/DatasetCrosstabber.html#270">270</a></td></tr><tr class="b"><td colspan='2'><div><pre>	}

	public void setDateFormat(final String dateFormat) {
		dateFormatter = new SimpleDateFormatter(dateFormat);
	}

	public DatasetMetadata getMetaData() {
		final DatasetMetadata meta = new DatasetMetadataImpl();

		return meta;
	}

	// // todo move to CollectionsHelper
	//
	// List&lt;Object&gt; toList(Object... o) {
	// ArrayList&lt;Object&gt; al = new ArrayList&lt;Object&gt;(o.length);
	// for (int i = 0; i &lt; o.length; i++) {
	// al.add(o[i]);
	// }
	// return al;
	// }

	@SuppressWarnings(&quot;unchecked&quot;)
	public ArrayList&lt;List&lt;Object&gt;&gt; getMatrixLists() {
		final Object[][] matrix = getMatrix();
		final ArrayList rows = new ArrayList(matrix.length);

		for (final Object[] element : matrix) {

			rows.add(ListHelper.toList(element));
		}
		return rows;

	}

	public CompoundCrosstabColumns getCrosstabColumns() {</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2012.
          All Rights Reserved.      
                
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
